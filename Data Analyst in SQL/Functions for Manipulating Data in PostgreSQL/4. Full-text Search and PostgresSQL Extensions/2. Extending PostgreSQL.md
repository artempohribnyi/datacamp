# 1. Extending PostgreSQL

The previous chapters in this course have explored many of the built-in functions of PostgreSQL which provide you with powerful tools for manipulating data using SQL. PostgreSQL also provides you with the ability to create your own custom data types, functions and operators to extend the functionality of your database.

# 2. User-defined data types

Let's take a look at custom or user-defined data types. A user-defined data type is created using the CREATE TYPE command which registers the type in a system table and makes it available to be used anywhere PostgreSQL expects a type name. Enumerated data types or enums allow you to define a custom list of values that are never going to change, like the days of the week. As you can see in this example, a new data type called dayofweek is defined as an ENUM using the CREATE TYPE command with a comma separated list of the days of the week.

![image](https://github.com/artempohribnyi/datacamp/assets/113499718/5809d10a-3b80-43e5-adea-a0d0ae4128cb)


# 3. Getting information about user-defined data types

Once your custom data type has been created, you can query the system table called pg_type to get information about all data types available in your database both user-defined and built-in. In this query you can get the name of the data type using the typname column and the category of the data type using the typcategory column. The results of the query return dayofweek for the name of the data type that we just created and E for the category where E represents an ENUM type.

![image](https://github.com/artempohribnyi/datacamp/assets/113499718/fd66ab1a-efe0-4fff-b9d1-413858da175b)


# 4. Getting information about user-defined data types

You can also use the INFORMATION_SCHEMA system database, as we learned about earlier in this course, to get information about user-defined data types. If we query INFORMATION_SCHEMA.COLUMNS and have a look at the columns in the film table specifically you'll notice that the column_name rating is a USER-DEFINED data_type with a udt_name of mpaa_rating. The udt_name column for a user_defined data type contains the value of the name provided when creating the data type using the CREATE TYPE command. You may sometimes find it necessary to learn about the characteristics of your data when working with a new database for the first time.

![image](https://github.com/artempohribnyi/datacamp/assets/113499718/953595c1-0b0f-460e-a74e-0b1f5efb2d97)


# 5. User-defined functions

Another way to extend the capabilities of your PostgreSQL database is with user-defined functions. A user-defined function is the PostgeSQL equivalent of a stored procedure where you can bundle several SQL queries and statements together into a single package using the CREATE FUNCTION command. In this example we define the function squared that accepts an integer, i, as an input parameter and returns the square of that parameter as the result. The double dollar sign syntax specifies that the function will be using SQL as the language.

![image](https://github.com/artempohribnyi/datacamp/assets/113499718/f95f9424-f1d8-43ae-9fdd-a1004e026a85)


# 6. User-defined functions in the Sakila database

In addition to being an excellent sample relational database, the Sakila DVD Rental Database that you've been using as the dataset throughout this course also showcases the power of PostgreSQL extensibility and comes pre-installed with a few examples of custom or user-defined functions for you to explore and experiment with. The get_customer_balance function takes a customer_id and a timestamp as input parameters and will calculate the current balance of a customer based on a customer_id as of the timestamp date. The inventory_held_by_customer function takes an inventory_id as an input parameter and will determine all rows that have a return_date equal to null which means the customer still has the rental. And finally the inventory_in_stock function takes an inventory_id as an input parameter and will determine if a specific inventory_id is in stock.

![image](https://github.com/artempohribnyi/datacamp/assets/113499718/ed53e8ca-1754-4f1f-a16c-18ed3b6dcba0)


# 7. Let's practice!

Let's take a closer look in the exercises.

# User-defined data types

ENUM or enumerated data types are great options to use in your database when you have a column where you want to store a fixed list of values that rarely change. Examples of when it would be appropriate to use an ENUM include days of the week and states or provinces in a country.

Another example can be the directions on a compass (i.e., north, south, east and west.) In this exercise, you are going to create a new ENUM data type called compass_position.

```
-- Create an enumerated data type, compass_position
CREATE TYPE compass_position AS ENUM (
  	-- Use the four cardinal directions
  	'North', 
  	'South',
  	'East', 
  	'West'
);
```
Verify that the new data type has been created by looking in the pg_type system table.
```
-- Create an enumerated data type, compass_position
CREATE TYPE compass_position AS ENUM (
  	-- Use the four cardinal directions
  	'North', 
  	'South',
  	'East', 
  	'West'
);
-- Confirm the new data type is in the pg_type system table
SELECT typname
FROM pg_type
WHERE typname='compass_position'; 
```
![image](https://github.com/artempohribnyi/datacamp/assets/113499718/1ed66e71-63ad-4548-8dc5-60dd0abb6f21)

# Getting info about user-defined data types

The Sakila database has a user-defined enum data type called mpaa_rating. The rating column in the film table is an mpaa_rating type and contains the familiar rating for that film like PG or R. This is a great example of when an enumerated data type comes in handy. Film ratings have a limited number of standard values that rarely change.

When you want to learn about a column or data type in your database the best place to start is the INFORMATION_SCHEMA. You can find information about the rating column that can help you learn about the type of data you can expect to find. For enum data types, you can also find the specific values that are valid for a particular enum by looking in the pg_enum system table. Let's dive into the exercises and learn more.

